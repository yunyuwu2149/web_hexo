{"title":"私有化部署Rocket.Chat在线聊天平台","uid":"372f0439b3c1a8d1b5aa334a3f639af0","slug":"私有化部署Rocket-Chat在线聊天平台","date":"2023-04-27T01:44:44.000Z","updated":"2023-04-27T01:46:56.492Z","comments":true,"path":"api/articles/私有化部署Rocket-Chat在线聊天平台.json","keywords":null,"cover":"https://image.yunyuwu.cn/typecho/uploads/2022/08/2277498494.webp","content":"<h2 id=\"Rocket-Chat是什么\"><a href=\"#Rocket-Chat是什么\" class=\"headerlink\" title=\"Rocket.Chat是什么\"></a>Rocket.Chat是什么</h2><p><strong>Rocket.Chat</strong>是一个开源的可高度定制的通信平台，用<code>JavaScript</code>开发，该项目功能齐全，并且还有各系统app。</p>\n<h2 id=\"部署环境\"><a href=\"#部署环境\" class=\"headerlink\" title=\"部署环境\"></a>部署环境</h2><ul>\n<li>已经安装好Docker及Docker-compose（有宝塔 软件商店安装Docker管理器即可）必需品</li>\n<li>RocketChat的版本：v4.5.1（2022-3-12的最新版）</li>\n<li>Node.js —v14.18.3，Mongodb （需要4.2以上）</li>\n</ul>\n<h2 id=\"开始部署\"><a href=\"#开始部署\" class=\"headerlink\" title=\"开始部署\"></a>开始部署</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># 创建并进入工作目录\nmkdir &#x2F;rocketchat\ncd &#x2F;rocketchat\n# 下载编排文件\ncurl -L https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;RocketChat&#x2F;Docker.Official.Image&#x2F;master&#x2F;compose.yml -O</code></pre>\n\n<p>根据自己的需求修改编排文件后保存，运行以下命令启动服务：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">docker-compose up -d</code></pre>\n\n<p>在经过一段时间的等待，服务器启动后访问<code>http://ip:3000</code></p>\n<p>然后我们跟着<strong>安装向导</strong>的指引一步步填写信息完成安装即可。</p>\n<p><img src=\"https://image.yunyuwu.cn/typecho/uploads/2022/08/4136857472.png\" alt=\"安装向导.png\"></p>\n<h2 id=\"反向代理及使用app\"><a href=\"#反向代理及使用app\" class=\"headerlink\" title=\"反向代理及使用app\"></a>反向代理及使用app</h2><h3 id=\"配置反向代理\"><a href=\"#配置反向代理\" class=\"headerlink\" title=\"配置反向代理\"></a>配置反向代理</h3><p>想使用域名访问的话，我们可以反向代理Rocket.Chat的端口，因为我安装了宝塔，所以操作很简单，然后配置SSL证书即可。<br><img src=\"https://image.yunyuwu.cn/typecho/uploads/2022/08/1283793732.png\" alt=\"宝塔反向代理配置.png\"></p>\n<p>但如果想要使用安卓移动应用使用的话，必须使用SSL（https）才可以，SSL可以在域名商或者其他平台进行申请，宝塔可以直接申请Let’s Encrypt证书。</p>\n<p>做完这一步之后，我们使用app连接，会发现提示<code>Websocket已于此伺服器上禁用。请联络系统管理员。</code>这是因为nginx没有启用Websocket。</p>\n<h3 id=\"Nginx开启Websocket\"><a href=\"#Nginx开启Websocket\" class=\"headerlink\" title=\"Nginx开启Websocket\"></a>Nginx开启Websocket</h3><p>找到<code>nginx.conf</code>编辑它，在**<code>http</code>上下文中**增加如下配置，</p>\n<pre class=\"line-numbers language-conf\" data-language=\"conf\"><code class=\"language-conf\">map $http_upgrade $connection_upgrade &#123;\n default upgrade;\n &#39;&#39;   close;\n&#125;</code></pre>\n<p>再**<code>server</code>上下文中**增加如下配置</p>\n<pre class=\"line-numbers language-conf\" data-language=\"conf\"><code class=\"language-conf\">  location &#x2F; &#123;\n   proxy_pass http:&#x2F;&#x2F;websocket;\n   proxy_read_timeout 300s;\n   proxy_set_header Host $host;\n   proxy_set_header X-Real-IP $remote_addr;\n   proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n   proxy_http_version 1.1;\n   proxy_set_header Upgrade $http_upgrade;\n   proxy_set_header Connection $connection_upgrade;\n&#125;\n&#125;</code></pre>\n<p>最后，我们到<strong>反向代理配置文件</strong>中添加如下代码</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">proxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection $connection_upgrade;</code></pre>\n<p><img src=\"https://image.yunyuwu.cn/typecho/uploads/2022/08/1174995247.png\" alt=\"反向代理配置文件.png\"></p>\n<p>到这，教程就结束了，可以正常使用app了。</p>\n<h2 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h2><ol>\n<li><a href=\"https://docs.rocket.chat/quick-start/deploying-rocket.chat/rapid-deployment-methods/docker-and-docker-compose\">Rocket.Chat官方文档</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/482686990\">Nginx代理WebSocket方法</a></li>\n</ol>\n","text":"Rocket.Chat是什么Rocket.Chat是一个开源的可高度定制的通信平台，用JavaScript开发，该项目功能齐全，并且还有各系统app。 部署环境 已经安装好Docker及Docker-compose（有宝塔 软件商店安装Docker管理器即可）必需品 Rocket...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"实用项目","slug":"实用项目","count":5,"path":"api/categories/实用项目.json"},{"name":"实用Docker项目","slug":"实用项目/实用Docker项目","count":4,"path":"api/categories/实用项目/实用Docker项目.json"}],"tags":[{"name":"Docker","slug":"Docker","count":5,"path":"api/tags/Docker.json"},{"name":"实用项目","slug":"实用项目","count":5,"path":"api/tags/实用项目.json"},{"name":"实用Docker项目","slug":"实用Docker项目","count":4,"path":"api/tags/实用Docker项目.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Rocket-Chat%E6%98%AF%E4%BB%80%E4%B9%88\"><span class=\"toc-text\">Rocket.Chat是什么</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">部署环境</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BC%80%E5%A7%8B%E9%83%A8%E7%BD%B2\"><span class=\"toc-text\">开始部署</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8app\"><span class=\"toc-text\">反向代理及使用app</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86\"><span class=\"toc-text\">配置反向代理</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Nginx%E5%BC%80%E5%90%AFWebsocket\"><span class=\"toc-text\">Nginx开启Websocket</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99\"><span class=\"toc-text\">参考资料</span></a></li></ol>","author":{"name":"小北","slug":"blog-author","avatar":"https://q1.qlogo.cn/g?b=qq&nk=2149264593&s=640","link":"/","description":"云起云散雾不止 <br /> @ <b>公众号：云与雾科技</b>","socials":{"github":"https://github.com/","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/","juejin":"https://juejin.cn/","customs":{}}},"mapped":true,"prev_post":{"title":"免费申请泛域名SSL证书","uid":"f9e71af5c85baf2849100d40efa0ddfa","slug":"免费申请泛域名SSL证书","date":"2023-04-27T01:48:57.000Z","updated":"2023-04-27T01:50:29.697Z","comments":true,"path":"api/articles/免费申请泛域名SSL证书.json","keywords":null,"cover":"https://image.yunyuwu.cn/typecho/uploads/2022/09/57147076.png","text":"SSL证书是什么？SSL证书是数字证书的一种，类似于驾驶证、护照和营业执照的电子副本。 因为配置在服务器上，也称为SSL服务器证书。 SSL 证书就是遵守 SSL协议 ，由受信任的数字证书颁发机构CA，在验证服务器身份后颁发，具有服务器身份验证和数据传输加密功能。 SSL证书通过...","link":"","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[{"name":"奇技淫巧","slug":"奇技淫巧","count":2,"path":"api/categories/奇技淫巧.json"}],"tags":[{"name":"奇技淫巧","slug":"奇技淫巧","count":2,"path":"api/tags/奇技淫巧.json"}],"author":{"name":"小北","slug":"blog-author","avatar":"https://q1.qlogo.cn/g?b=qq&nk=2149264593&s=640","link":"/","description":"云起云散雾不止 <br /> @ <b>公众号：云与雾科技</b>","socials":{"github":"https://github.com/","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/","juejin":"https://juejin.cn/","customs":{}}}},"next_post":{"title":"如何安装Nginx Proxy Manager","uid":"8254044e3244d0ee31edb99fcba5d35b","slug":"如何安装Nginx Proxy Manager","date":"2023-04-27T01:41:17.000Z","updated":"2023-04-27T01:43:09.558Z","comments":true,"path":"api/articles/如何安装Nginx Proxy Manager.json","keywords":null,"cover":"https://image.yunyuwu.cn/typecho/uploads/2022/08/1004077655.png","text":"什么是Nginx Proxy Manager？这是官网的一段话：This project comes as a pre-built docker image that enables you to easily forward to your websites running a...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"实用项目","slug":"实用项目","count":5,"path":"api/categories/实用项目.json"},{"name":"实用Docker项目","slug":"实用项目/实用Docker项目","count":4,"path":"api/categories/实用项目/实用Docker项目.json"}],"tags":[{"name":"Docker","slug":"Docker","count":5,"path":"api/tags/Docker.json"},{"name":"实用项目","slug":"实用项目","count":5,"path":"api/tags/实用项目.json"},{"name":"实用Docker项目","slug":"实用Docker项目","count":4,"path":"api/tags/实用Docker项目.json"}],"author":{"name":"小北","slug":"blog-author","avatar":"https://q1.qlogo.cn/g?b=qq&nk=2149264593&s=640","link":"/","description":"云起云散雾不止 <br /> @ <b>公众号：云与雾科技</b>","socials":{"github":"https://github.com/","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/","zhihu":"https://www.zhihu.com/","csdn":"https://blog.csdn.net/","juejin":"https://juejin.cn/","customs":{}}}}}